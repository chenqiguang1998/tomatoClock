# Tomato Test

一个基于Flutter的番茄工作法应用，帮助您提高工作效率。

## 功能特性

- 番茄计时器
- 任务管理
- 时间统计
- 历史记录

---

## 番茄时钟 App 开发计划与版本管理建议 (V1.0)

## 核心理念回顾
将日常日程管理转变为一场有趣的个人成长游戏。通过游戏化的 UI、动态的文字剧情和数据化的反馈，帮助用户提升专注力、掌握时间，并培养积极的心态。
## 一、建议的项目里程碑与版本规划
### 为了高效开发并逐步交付价值，建议将项目拆分为以下几个主要版本：
### V1.0 - 核心功能 MVP (最小可行产品)
#### 目标： 实现 App 的核心计时和任务管理功能，确保基础的可用性和稳定性。
#### 主要功能点：
**# 功能模块**
    • A. 时间流程图 (Daily Timeline / Schedule View) - 基础版     
        ◦ 可视化界面：纵向滚动时间轴 (最小时间颗粒度 5 分钟)，横向滑动日期轴。
        ◦ 任务管理：新建任务 (名称、时长、颜色)，任务条自动吸附刻度。
        ◦ 拖拽行为：禁止时间重叠，被占用时默认置顶。
        ◦ 锁定机制：已过去任务条锁定，仅可查看。
    • C. 任务便利贴 (Task Pop-up & Tracking) - 基础版
        ◦ 番茄钟：默认开启，可关闭，专注 40 分钟，休息 15 分钟 (固定时长，设置中暂不可调)。自动提醒下一步操作。
        ◦ 计时与暂停：任务开始计时，支持暂停/继续，总用时累加。
        ◦ 用时反馈：实际用时以荧光色条绘制在计划条下方。
        ◦ 暂停时的视觉表现：荧光色条断开。
        ◦ 超时表现：荧光条超出计划条范围。
        ◦ 超时处理：任务到期继续计时直至手动结束。
技术实现重点：
    • 搭建基础 UI 框架。
    • 实现时间轴与日期轴的渲染和交互逻辑。
    • 实现任务的创建、存储 (本地数据库)、拖拽和锁定。
    • 实现番茄钟计时器、暂停/继续逻辑。
    • 绘制任务计划与实际用时条。
    • 架构模式： MVVM 架构的基础搭建。
    • 本地数据库： 使用 SQLite 存储任务数据。
V1.5 - 游戏化与个性化体验增强
目标： 引入游戏化元素，提升用户粘性与趣味性，并提供基础的个性化设置。
主要功能点：
    • B. 游戏化系统 - 初版
        ◦ 动态文字游戏：在每天首次打开 App 时显示 (根据任务完成情况简单生成)。
        ◦ 人格小人：在游戏面板上显示基础动画和状态变化。
        ◦ 数值与经验加成：实现“专注度”和“完成率”的计算与显示，完成任务获得经验加成 (按时、提前、超时)。
    • C. 任务便利贴 - 增强版
        ◦ 番茄钟设置：在设置中开放专注时长和休息时长的自定义功能。
    • D. 心情日记 - 初版
        ◦ 触发机制：在当天预设时间 (如晚上10点) 自动弹出写日记提醒。
        ◦ 手动化：App 内指定入口手动触发。
    • E. 数据管理与同步 - 初版
        ◦ 数据同步：采用一次性生成的加密二维码作为同步方式。
        ◦ 版本号机制：数据中加入版本号。
        ◦ 冲突解决机制：提供手动选择 (此条/全部覆盖) 选项。
        ◦ 记录所有修改历史。
技术实现重点：
    • 游戏化 UI 组件开发 (人格小人、数值显示)。
    • 动态文字游戏逻辑与简单内容生成。
    • 情绪日记的输入与本地存储。
    • 二维码生成与解析 (加密数据)。
    • 数据版本管理与冲突解决逻辑。
    • 数据加密： 实现二维码生成前的数据加密。
V2.0 - 数据分析与深度游戏化
目标： 提供有价值的数据反馈，并深化游戏化体验，增加用户长期使用的动力。
主要功能点：
    • B. 游戏化系统 - 增强版
        ◦ 动态文字游戏：当天结束时弹出日记提醒。根据情绪记录等更丰富的数据动态生成内容。
        ◦ 剧情包：实现后期剧情包的更新和完善机制。
        ◦ 可切换主题：实现高度解耦和工厂化设计，支持主题切换 (例如：游戏主题、简约主题)。每个主题改变整体布局、音效和显示元素。
    • E. 数据管理与同步 - 增强版
        ◦ 数据分析：提供可视化数据分析图表 (每日专注时长趋势图、任务类型占比饼图、计划时长与实际用时的偏差散点图)。
技术实现重点：
    • 数据分析模块的开发，集成图表库。
    • 更复杂的动态文字游戏内容生成逻辑。
    • 主题切换的实现，包括 UI 布局、音效、元素变化的动态加载。
    • 优化数据同步的稳定性和用户体验。
二、技术实现与架构建议细化
    • 架构模式 (MVVM)：
        ◦ Model： 负责数据逻辑，如任务数据结构、日记内容、数值计算、数据加密、数据库交互等。
        ◦ ViewModel： 连接 Model 和 View，处理业务逻辑，如计时器的启动/暂停、任务拖拽逻辑、游戏数值更新、数据同步触发等，并向 View 暴露可观察的数据。
        ◦ View： 负责 UI 渲染和用户交互，如时间轴显示、任务条绘制、番茄钟界面、人格小人动画、主题切换效果等。
        ◦ 优势： 这种分离使得 UI 更改 (如主题切换) 不影响核心业务逻辑，且单元测试更容易。
    • 数据加密：
        ◦ 建议使用业界标准的对称加密算法 (如 AES)，密钥在设备本地安全存储或通过用户输入的密码生成。
        ◦ 传输： 二维码传输加密后的数据。
    • 本地数据库 (SQLite)：
        ◦ 存储所有任务 (包括计划时长、实际用时、状态、颜色等)、日记内容、游戏数值、修改历史。
        ◦ 修改历史： 为每个任务记录一个操作日志，包含操作类型 (创建、修改、删除)、时间戳和修改前后的数据快照，以便回滚。
三、产品设计与用户体验建议细化
    • 游戏化深度：
        ◦ 成就系统： 定义一系列成就，例如“专注大师 (连续完成 7 天番茄钟)”、“时间管理专家 (月计划完成率达 90%)”等，完成后给予虚拟奖励或徽章。
        ◦ 技能树： 可以将一些高级功能 (如多任务番茄钟、自定义休息音乐) 设计为“技能”，通过积累专注度经验值来解锁，增加用户的长期目标。
    • 情感反馈：
        ◦ 人格小人可以设计多种情绪状态：高兴 (按时完成任务)、沮丧 (任务中断或超时)、困惑 (长时间无操作)、活力 (休息结束准备开始)。通过微动画和表情变化来表达。
    • 逐步引导：
        ◦ 首次启动时，设计一个简洁的 onboarding 流程，通过动画和提示框逐步介绍“如何新建任务”、“如何开始番茄钟”、“游戏面板在哪里”等关键操作。
    • 付费模式：
        ◦ 基础功能免费： 核心的番茄钟、任务管理、基本游戏化和心情日记。
        ◦ 增值功能付费：
            ▪ 主题包： 提供多种风格迥异的 UI 主题。
            ▪ 定制化剧情包： 更多、更丰富的动态文字剧情。
            ▪ 高级数据分析报告： 更深入、个性化的数据洞察，导出功能。
            ▪ 额外的人格小人皮肤/动画。
            ▪ 云同步 (后期考虑)： 如果用户需要更便捷的多设备同步，可以作为高级功能。**
---

### **番茄时钟 App 最终需求清单 (V1.0)**

#### **核心理念：**
将日常日程管理转变为一场有趣的**个人成长游戏**。通过游戏化的 UI、动态的文字剧情和数据化的反馈，帮助用户提升专注力、掌握时间，并培养积极的心态。

---

#### **一、核心功能模块**

**A. 时间流程图（Daily Timeline / Schedule View）**
- **可视化界面：**
  - **时间轴：** 采用**纵向滚动轴**设计，最小时间颗粒度默认为 **5 分钟**，可在设置中调整。
  - **日期轴：** 采用**横向滑动**日历，方便用户快速切换日期。
- **任务管理：**
  - **新建与编辑：** 新建任务时，可以设置任务名称、计划时长和颜色。任务条会自动**吸附到最近的刻度**上。
  - **拖拽行为：** 拖拽任务条时，App 将**禁止任何时间上的重叠**。如果目标时间段已被占用，拖拽的任务条将默认**置于最上方**。
  - **锁定机制：** **已过去的任务条将被锁定**，不可编辑和移动，仅能查看详情。

**B. 游戏化系统**
- **动态文字游戏：**
  - **触发时机：** 在每天**首次打开 App** 和**当天结束（弹出日记提醒）**时显示。
  - **内容生成：** 文字内容**根据用户当天的任务完成情况、情绪记录等动态生成**。
  - **剧情包：** App 后期将支持**剧情包**的更新和完善，增加游戏深度。
- **人格小人：**
  - 在游戏面板上显示**代表用户的人格小人**，其动画和状态会根据用户表现实时变化。
- **数值与经验加成：**
  - **数值体系：** 核心数值包括“**专注度**”（完成番茄钟任务获得）、“**完成率**”（计划与实际用时对比）等。
  - **经验加成：** 完成任务时，根据**任务的完成度**（例如，按时完成、提前完成、超时完成）获得不同的**数值经验加成**。
- **可切换主题：**
  - UI 采用高度**解耦和工厂化**的设计。
  - 支持主题切换，每个主题会**改变整体布局、音效和显示元素**。例如，游戏主题下任务条是“血条”，未来可扩展为简约主题、赛博朋克主题等。

**C. 任务便利贴（Task Pop-up & Tracking）**
- **番茄钟：**
  - **默认开启**，可手动关闭。专注时长 40 分钟，休息时长 15 分钟，均可在设置中自定义。
  - 每轮专注或休息结束后，会**自动提醒**用户进行下一步操作。
- **计时与暂停：**
  - 任务开始后，计时器开始。用户点击“**暂停**”时，便利贴会隐藏。
  - 点击“**继续**”时，计时**从当前时间重新计算**，但任务的**总用时会进行累加**，以确保数据的准确性。
- **用时反馈：**
  - 在时间流程图上，**实际用时会以荧光色条绘制**，位于原计划条下方。
  - **暂停时的视觉表现：** 荧光色条会**断开显示**，精确记录用户中断和继续的时间点，反映用户的执行情况和耗时。
  - **超时表现：** 如果实际用时超出计划，荧光条将**超出原计划条的范围**，直观展示超时情况。
- **超时处理：**
  - 如果任务规划时间已到但未结束，App 会**继续计时**，直到用户手动点击结束。

**D. 心情日记**
- **触发机制：**
  - **自动化：** 在**当天时间达到某个预设点**（如晚上10点，可在设置中自定义）时，自动弹出写日记提醒。
  - **手动化：** 任何时候用户都可以通过 App 内的指定入口**手动触发**日记功能。

**E. 数据管理与同步**
- **数据分析（后期任务）：**
  - 后期将提供可视化数据分析图表，包括：
    - **每日专注时长趋势图**
    - **任务类型占比饼图**
    - **计划时长与实际用时的偏差散点图**
- **数据同步（非联网）：**
  - 采用**一次性生成的加密二维码**作为同步方式。
  - **版本号机制：** 在同步数据中加入版本号，用于判断哪份数据是最新版本。
  - **冲突解决机制：**
    - 如果两台设备同时修改了同一任务，同步时将**让用户手动选择**。
    - 提供“**选择此条**”或“**全部覆盖**”的选项。
    - 所有修改历史都将被**记录下来**，以便在出现问题时进行**回滚**。

---

### **技术实现与架构建议**

- **架构模式：** 推荐使用 **MVVM (Model-View-ViewModel)** 架构，以确保 UI 渲染、数据管理和游戏逻辑的高度解耦，便于未来功能扩展和主题切换。
- **数据加密：** 在二维码生成前，对数据进行加密，以确保数据传输的安全性。
- **本地数据库：** 使用 SQLite 等本地数据库存储所有任务、日记和修改历史，以支持非联网模式下的数据回滚功能。

---

### **产品设计与用户体验建议**

- **游戏化深度：** 除了基础的数值加成，可以考虑加入**成就系统**和**简单的“技能树”**，让用户通过完成任务解锁新的奖励和功能。
- **情感反馈：** 让人格小人拥有“情绪”，根据用户的表现（如按时完成、中断等）做出相应的情绪动画，增强情感联结。
- **逐步引导：** 首次启动 App 时，提供一个**交互式教程**，向用户逐步介绍每个核心功能，降低学习成本。
- **付费模式：** 可以考虑**基础功能免费，增值功能付费**的模式，例如提供更多的主题包、定制化的剧情包、更详尽的数据分析报告等。




## 开发环境

- Flutter 3.13.0
- Dart 3.1.0

## 安装运行

1. 确保已安装Flutter SDK
2. 克隆项目
3. 运行 `flutter pub get` 安装依赖
4. 运行 `flutter run` 启动应用

## 项目结构

- `lib/` - 主要Dart代码
  - `views/` - 界面组件
  - `models/` - 数据模型
  - `viewmodels/` - 视图模型
- `android/` - Android平台代码
- `ios/` - iOS平台代码
- `macos/` - macOS平台代码
- `linux/` - Linux平台代码
- `windows/` - Windows平台代码
- `web/` - Web平台代码

## 贡献指南

欢迎提交Pull Request。请确保代码风格一致并通过所有测试。

## 许可证

MIT

---

# tomatoClock